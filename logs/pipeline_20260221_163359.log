[16:33:59] [INFO] ============================================================
[16:33:59] [INFO]   BLUEPRINT LLM PIPELINE â€” TRAIN-ONLY
[16:33:59] [INFO] ============================================================
[16:33:59] [INFO] Root: C:\BlueprintLLM
[16:33:59] [INFO] Time: 2026-02-21 16:33:59
[16:33:59] [INFO] Last run: 2026-02-21T16:31:34.224525
[16:33:59] [INFO] Model: v0
[16:33:59] [INFO] ============================================================
[16:33:59] [INFO]   STEP 5: Train Model
[16:33:59] [INFO] ============================================================
[16:33:59] [INFO] Training v1 (data hash: 4cc7d21000d801d5)
[16:33:59] [INFO] Running: Fine-tuning v1
[16:33:59] [INFO]   Cmd: C:\BlueprintLLM\venv\Scripts\python.exe C:\BlueprintLLM\scripts\04_train_blueprint_lora.py --base_model meta-llama/Llama-3.2-3B --dataset C:\BlueprintLLM\datasets\train.jsonl --output C:\BlueprintLLM\models\blueprint-lora-v1 --epochs 3 --batch_size 1 --lr 0.0002 --lora_r 64
[16:34:16] [INFO]   | Loading enhanced system prompt with node reference...
[16:34:16] [INFO]   |   Loaded enhanced system prompt from C:\BlueprintLLM\scripts\system_prompt.txt
[16:34:16] [INFO]   |   (5,660 chars, ~1,415 tokens)
[16:34:16] [INFO]   | GPU: NVIDIA GeForce GTX 1070
[16:34:16] [INFO]   | VRAM: 8.0 GB
[16:34:16] [INFO]   | NOTE: 8 GB VRAM detected. Adjusting config for low-VRAM GPU.
[16:34:16] [INFO]   |   Reduced LoRA rank to 32 (alpha=64)
[16:34:16] [INFO]   |   Reduced max_seq_length to 2048
[16:34:16] [INFO]   |   Gradient checkpointing enabled
[16:34:16] [INFO]   | Loaded 1393 examples from C:\BlueprintLLM\datasets\train.jsonl
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | --- Sample formatted example (first 300 chars) ---
[16:34:16] [INFO]   | <|begin_of_text|><|start_header_id|>system<|end_header_id|>
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | You are a Blueprint programming assistant for Unreal Engine 5. Given a natural language description of desired game behavior, you generate valid Blueprint DSL code that implements that behavior.
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | ## DSL FORMAT RULES
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | Your output MUST follo
[16:34:16] [INFO]   | --- End sample ---
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | Loaded 30 examples from C:\BlueprintLLM\datasets\validation.jsonl
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | --- Sample formatted example (first 300 chars) ---
[16:34:16] [INFO]   | <|begin_of_text|><|start_header_id|>system<|end_header_id|>
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | You are a Blueprint programming assistant for Unreal Engine 5. Given a natural language description of desired game behavior, you generate valid Blueprint DSL code that implements that behavior.
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | ## DSL FORMAT RULES
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | Your output MUST follo
[16:34:16] [INFO]   | --- End sample ---
[16:34:16] [INFO]   | 
[16:34:16] [INFO]   | Loading base model: meta-llama/Llama-3.2-3B
[16:34:16] [INFO]   | Using 4-bit quantization (QLoRA)
[16:34:16] [INFO]   | Trainable parameters: 48,627,712 / 3,261,377,536 (1.49%)
[16:34:16] [ERROR]   FAILED (exit 1)
[16:34:16] [ERROR]   ERR| Traceback (most recent call last):
[16:34:16] [ERROR]   ERR|   File "C:\BlueprintLLM\scripts\04_train_blueprint_lora.py", line 337, in train
[16:34:16] [ERROR]   ERR|     trainer = SFTTrainer(
[16:34:16] [ERROR]   ERR|               ^^^^^^^^^^^
[16:34:16] [ERROR]   ERR| TypeError: SFTTrainer.__init__() got an unexpected keyword argument 'max_seq_length'
[16:34:16] [ERROR]   ERR| 
[16:34:16] [ERROR]   ERR| During handling of the above exception, another exception occurred:
[16:34:16] [ERROR]   ERR| 
[16:34:16] [ERROR]   ERR| Traceback (most recent call last):
[16:34:16] [ERROR]   ERR|   File "C:\BlueprintLLM\scripts\04_train_blueprint_lora.py", line 527, in <module>
[16:34:16] [ERROR]   ERR|     main()
[16:34:16] [ERROR]   ERR|   File "C:\BlueprintLLM\scripts\04_train_blueprint_lora.py", line 520, in main
[16:34:16] [ERROR]   ERR|     model_path = train(config)
[16:34:16] [ERROR]   ERR|                  ^^^^^^^^^^^^^
[16:34:16] [ERROR]   ERR|   File "C:\BlueprintLLM\scripts\04_train_blueprint_lora.py", line 349, in train
[16:34:16] [ERROR]   ERR|     trainer = SFTTrainer(
[16:34:16] [ERROR]   ERR|               ^^^^^^^^^^^
[16:34:16] [ERROR]   ERR| TypeError: SFTTrainer.__init__() got an unexpected keyword argument 'tokenizer'
[16:34:16] [INFO] ============================================================
[16:34:16] [INFO]   PIPELINE COMPLETE
[16:34:16] [INFO] ============================================================
[16:34:16] [INFO] Time: 0m 16s
[16:34:16] [INFO] Version: v0
[16:34:16] [INFO] Errors: 19
